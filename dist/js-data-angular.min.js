/*!
* js-data-angular
* @version 2.4.0 - Homepage <https://www.js-data.io/docs/js-data-angular/>
* @author Jason Dobry <jason.dobry@gmail.com>
* @copyright (c) 2014-2015 Jason Dobry <https://github.com/jmdobry/>
* @license MIT <https://github.com/js-data/js-data-angular/blob/master/LICENSE>
*
* @overview Angular wrapper for js-data.
*/

!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(function(){try{return require("js-data")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):"function"==typeof define&&define.amd?define(["js-data","angular"],b):"object"==typeof exports?exports.jsDataAngularModuleName=b(function(){try{return require("js-data")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):a.jsDataAngularModuleName=b(a.JSData,a.angular)}(this,function(a,b){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.m=a,c.c=b,c.p="",c(0)}([function(a,b,c){function t(a){var b=void 0;try{b=c(3)(a.project)}catch(d){}b||(b=window[a["class"]]),b&&("sails"===a.name&&(q=!0),a.loaded=!0,f.module("js-data").provider(a["class"],function(){var a=this;a.defaults={},a.$get=[function(){return new b(a.defaults)}]}))}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(b,"__esModule",{value:!0});var f=void 0,g=void 0;try{g=c(1)}catch(h){}if(!g)try{g=window.JSData}catch(h){}if(!g)throw new Error("js-data must be loaded!");try{f=c(2)}catch(h){}if(!f)try{f=window.angular}catch(h){}if(!f)throw new Error("angular must be loaded!");var i=g.DSUtils,j=g.DSErrors,k=i.deepMixIn,l=i.copy,m=i.removeCircular,n=i.isString,o=i.isNumber,p=i.makePath,q=!1,r=[{project:"js-data-sails",name:"sails","class":"DSSailsAdapter"},{project:"js-data-localstorage",name:"localstorage","class":"DSLocalStorageAdapter"},{project:"js-data-localforage",name:"localforage","class":"DSLocalForageAdapter"},{project:"js-data-firebase",name:"firebase","class":"DSFirebaseAdapter"},{project:"js-data-sql",name:"sql","class":"DSSqlAdapter"}],s=["compute","digest","eject","inject","link","linkAll","linkInverse","unlinkInverse"],u=function w(){function d(){function l(a){var b=h.defer();try{a.call(void 0,f.bind(b,b.resolve),f.bind(b,b.reject))}catch(c){b.reject(c)}return b.promise}for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];var e=c[c.length-2],h=c[c.length-1],j=new g.DS(a.defaults),k={};if(l.all=h.all,l.when=h.when,l.reject=h.reject,i.Promise=l,c.length)for(var m=0;m<c.length;m++)for(var n=0;n<r.length;n++)if(r[n].loaded&&!r[n].registered){r[n].registered=!0,j.registerAdapter(r[n].name,c[m]);break}for(var o=function(){var a=s[p];k[a]=j[a],j[a]=function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return e.$$phase?k[a].apply(j,c):e.$apply(function(){return k[a].apply(j,c)})}},p=0;p<s.length;p++)o();return("function"!=typeof Object.observe||"function"!=typeof Array.observe)&&e.$watch(function(){return j.observe.Platform.performMicrotaskCheckpoint()}),j}e(this,w);for(var a=this,b=[],c=0;c<r.length;c++)r[c].loaded&&b.push(r[c]["class"]);a.defaults={},g.DS.prototype.bindAll=function(a,b,c,d,e){var f=this;if(b=b||{},!f.definitions[a])throw new j.NER(a);if(!i.isObject(b))throw new j.IA('"params" must be an object!');if(!i.isObject(c))throw new j.IA('"scope" must be an object!');if(!i.isString(d))throw new j.IA('"expr" must be a string!');try{return c.$watch(function(){return f.lastModified(a)},function(){var g=f.filter(a,b);i.set(c,d,g),e&&e(null,g)})}catch(g){if(!e)throw g;e(g)}},g.DS.prototype.bindOne=function(a,b,c,d,e){var f=this;if(b=i.resolveId(f.definitions[a],b),!f.definitions[a])throw new j.NER(a);if(!i.isString(b)&&!i.isNumber(b))throw new j.IA('"id" must be a string or a number!');if(!i.isObject(c))throw new j.IA('"scope" must be an object!');if(!i.isString(d))throw new j.IA('"expr" must be a string!');try{return c.$watch(function(){return f.lastModified(a,b)},function(){var g=f.get(a,b);g&&f.compute(a,b),i.set(c,d,g),e&&e(null,g)})}catch(g){if(!e)throw g;e(g)}},b.push("$rootScope"),b.push("$q"),b.push(d),a.$get=b};f.module("js-data",["ng"]).value("DSUtils",g.DSUtils).value("DSErrors",g.DSErrors).provider("DS",u);for(var v=0;v<r.length;v++)t(r[v]);q||function(){var a=function(){function a(){e(this,a)}return d(a,[{key:"queryTransform",value:function(a,b){return b}},{key:"deserialize",value:function(a,b){return b?"data"in b?b.data:b:b}},{key:"serialize",value:function(a,b){return b}},{key:"log",value:function(){}},{key:"error",value:function(){}}]),a}(),b=a.prototype;b.basePath="",b.forceTrailingSlash="",b.sailsConfig={};var c=function(){function b(c){e(this,b),this.defaults=new a,console&&(this.defaults.log=function(a,b){return console["function"==typeof console.info?"info":"log"](a,b)}),console&&(this.defaults.error=function(a,b){return console["function"==typeof console.error?"error":"log"](a,b)}),k(this.defaults,c)}return d(b,[{key:"getPath",value:function(a,b,c,d){var e=this;d=d||{};var f=[d.basePath||e.defaults.basePath||b.basePath,b.getEndpoint(n(c)||o(c)||"create"===a?c:null,d)];return("find"===a||"update"===a||"destroy"===a)&&f.push(c),p.apply(i,f)}},{key:"GET",value:function(a,b){return b=b||{},"method"in b||(b.method="get"),this.SAILS(k(b,{url:a}))}},{key:"POST",value:function(a,b,c){return c=c||{},c=i.copy(c),"method"in c||(c.method="post"),this.SAILS(k(c,{url:a,data:b}))}},{key:"PUT",value:function(a,b,c){return c=c||{},"method"in c||(c.method="put"),this.SAILS(k(c,{url:a,data:b||{}}))}},{key:"DEL",value:function(a,b){return b=b||{},"method"in b||(b.method="delete"),this.SAILS(k(b,{url:a}))}},{key:"find",value:function(a,b,c){var d=this;return c=c?l(c):{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},c.params=d.defaults.queryTransform(a,c.params),d.GET(d.getPath("find",a,b,c),c).then(function(b){var e=(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b);return e?e:g.DSUtils.Promise.reject(new Error("Not Found!"))})}},{key:"findAll",value:function(a,b,c){var d=this;return c=c?l(c):{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},b&&(b=d.defaults.queryTransform(a,b),k(c.params,b)),d.GET(d.getPath("findAll",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})}},{key:"create",value:function(a,b,c){var d=this;return c=c?l(c):{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},c.params=d.defaults.queryTransform(a,c.params),d.POST(d.getPath("create",a,b,c),(c.serialize?c.serialize:d.defaults.serialize)(a,b),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})}},{key:"update",value:function(a,b,c,d){var e=this;return d=d?l(d):{},d.suffix=d.suffix||a.suffix,d.params=d.params||{},d.params=e.defaults.queryTransform(a,d.params),e.PUT(e.getPath("update",a,b,d),(d.serialize?d.serialize:e.defaults.serialize)(a,c),d).then(function(b){return(d.deserialize?d.deserialize:e.defaults.deserialize)(a,b)})}},{key:"updateAll",value:function(a,b,c,d){var e=this;return d=d?l(d):{},d.suffix=d.suffix||a.suffix,d.params=d.params||{},c&&(c=e.defaults.queryTransform(a,c),k(d.params,c)),this.PUT(e.getPath("updateAll",a,b,d),(d.serialize?d.serialize:e.defaults.serialize)(a,b),d).then(function(b){return(d.deserialize?d.deserialize:e.defaults.deserialize)(a,b)})}},{key:"destroy",value:function(a,b,c){var d=this;return c=c?l(c):{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},c.params=d.defaults.queryTransform(a,c.params),d.DEL(d.getPath("destroy",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})}},{key:"destroyAll",value:function(a,b,c){var d=this;return c=c?l(c):{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},b&&(b=d.defaults.queryTransform(a,b),k(c.params,b)),this.DEL(d.getPath("destroyAll",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})}}]),b}(),h=c.prototype,j=function q(){e(this,q);var a=this;a.defaults={},a.$get=["$sails","DS","$q",function(b,d,e){h.SAILS=function(a){function g(a){var b=""+d.toUTCString()+" - "+a.config.method.toUpperCase()+" "+a.config.url+" - "+a.status+" "+((new Date).getTime()-d.getTime())+"ms";return a.status>=200&&a.status<300?(c.defaults.log&&c.defaults.log(b,a),a):(c.defaults.error&&c.defaults.error("FAILED: "+b,a),e.reject(a))}var c=this,d=new Date;a=l(a),a=k(a,c.defaults.sailsConfig),c.defaults.forceTrailingSlash&&"/"!==a.url[a.url.length-1]&&(a.url+="/"),a.method=a.method.toUpperCase(),"object"==typeof a.data&&(a.data=m(a.data));var f=a.suffix||c.defaults.suffix;return f&&a.url.substr(a.url.length-f.length)!==f&&(a.url+=f),b(a).then(g,g)};var f=new c(a.defaults);return d.registerAdapter("sails",f,{"default":!0}),f}]};f.module("js-data").provider("DSSailsAdapter",j)}(),f.module("js-data").run(["DS","DSSailsAdapter",function(a,b){return a.registerAdapter("sails",b,{"default":!0})}]),b["default"]="js-data",a.exports=b["default"]},function(b){if("undefined"==typeof a){var e=new Error('Cannot find module "undefined"');throw e.code="MODULE_NOT_FOUND",e}b.exports=a},function(a){if("undefined"==typeof b){var e=new Error('Cannot find module "angular"');throw e.code="MODULE_NOT_FOUND",e}a.exports=b},function(a,b,c){function e(a){return c(f(a))}function f(a){return d[a]||function(){throw new Error("Cannot find module '"+a+"'.")}()}var d={};e.keys=function(){return Object.keys(d)},e.resolve=f,a.exports=e,e.id=3}])});
